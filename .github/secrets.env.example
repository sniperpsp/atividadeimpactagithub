# ==============================================================================
# GitHub Secrets Configuration Template
# ==============================================================================
# Este arquivo serve como template para configurar os secrets necessários
# no GitHub Actions. NÃO COMMITE ESTE ARQUIVO COM VALORES REAIS!
# ==============================================================================

# ------------------------------------------------------------------------------
# AWS Credentials (OBRIGATÓRIO)
# ------------------------------------------------------------------------------
# Como obter:
# 1. AWS Console → IAM → Users → Seu usuário
# 2. Security credentials → Create access key
# 3. Escolha "Application running outside AWS"
# 4. Copie os valores abaixo

AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# ------------------------------------------------------------------------------
# Infracost API Key (OPCIONAL - Recomendado)
# ------------------------------------------------------------------------------
# Como obter:
# 1. Acesse: https://dashboard.infracost.io/
# 2. Crie uma conta gratuita
# 3. Settings → API Keys → Create API Key
# 4. Copie o valor abaixo

INFRACOST_API_KEY=ico-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ------------------------------------------------------------------------------
# Como configurar no GitHub
# ------------------------------------------------------------------------------
# Via GitHub UI:
# 1. Acesse: https://github.com/<org>/<repo>/settings/secrets/actions
# 2. Clique em "New repository secret"
# 3. Nome: AWS_ACCESS_KEY_ID
# 4. Value: Cole o valor acima
# 5. Clique em "Add secret"
# 6. Repita para AWS_SECRET_ACCESS_KEY e INFRACOST_API_KEY

# Via GitHub CLI (gh):
# echo "AKIAIOSFODNN7EXAMPLE" | gh secret set AWS_ACCESS_KEY_ID
# echo "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY" | gh secret set AWS_SECRET_ACCESS_KEY
# echo "ico-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" | gh secret set INFRACOST_API_KEY

# Via Script PowerShell:
# .\scripts\setup-cicd.ps1

# ------------------------------------------------------------------------------
# Permissões IAM Necessárias
# ------------------------------------------------------------------------------
# O usuário AWS deve ter as seguintes permissões:
# - EC2 (Full Access)
# - VPC (Full Access)
# - S3 (Full Access)
# - RDS (Full Access)
# - EKS (Full Access)
# - ElastiCache (Full Access)
# - Route 53 (Full Access)
# - ACM (Full Access)
# - WAF (Full Access)
# - CloudWatch (Full Access)
# - IAM (Full Access)
# - Secrets Manager (Full Access)
# - SQS (Full Access)
# - Elastic Load Balancing (Full Access)

# Ou use a política gerenciada:
# - PowerUserAccess (recomendado para desenvolvimento)
# - AdministratorAccess (apenas se necessário)

# ------------------------------------------------------------------------------
# Ambientes GitHub (OBRIGATÓRIO)
# ------------------------------------------------------------------------------
# Configure os seguintes ambientes em:
# Settings → Environments → New environment

# 1. production
#    - Required reviewers: Adicione usuários que devem aprovar deploys
#    - Wait timer: 0 minutes (ou defina um tempo de espera)

# 2. destroy-prod
#    - Required reviewers: Adicione usuários que devem aprovar destruição
#    - Wait timer: 5 minutes (tempo para cancelar se necessário)

# 3. destroy-staging
#    - Required reviewers: Adicione usuários que devem aprovar destruição
#    - Wait timer: 0 minutes

# ------------------------------------------------------------------------------
# Verificação
# ------------------------------------------------------------------------------
# Após configurar, verifique se os secrets estão corretos:

# 1. Via GitHub Actions:
#    - Crie um PR de teste
#    - Verifique se o workflow "Terraform Plan" executa sem erros

# 2. Via AWS CLI (local):
#    aws sts get-caller-identity
#    # Deve retornar informações do usuário AWS

# 3. Via Infracost (local):
#    infracost auth login
#    # Deve autenticar com sucesso

# ------------------------------------------------------------------------------
# Segurança
# ------------------------------------------------------------------------------
# ⚠️ IMPORTANTE:
# - NUNCA commite credenciais reais no repositório
# - Use secrets do GitHub para armazenar credenciais
# - Rotacione credenciais regularmente (a cada 90 dias)
# - Use usuários IAM específicos para CI/CD (não use root)
# - Habilite MFA no usuário IAM
# - Monitore uso de credenciais via CloudTrail

# ------------------------------------------------------------------------------
# Troubleshooting
# ------------------------------------------------------------------------------
# Se os workflows falharem:

# 1. Verifique se os secrets estão configurados:
#    Settings → Secrets → Actions

# 2. Verifique se os valores estão corretos (sem espaços extras)

# 3. Verifique permissões IAM do usuário

# 4. Teste credenciais localmente:
#    export AWS_ACCESS_KEY_ID="..."
#    export AWS_SECRET_ACCESS_KEY="..."
#    aws sts get-caller-identity

# 5. Verifique logs do workflow:
#    Actions → Failed workflow → View logs
